# üß† OuvIoT ‚Äì Backend  


Esta parte do reposit√≥rio representa o **Backend (API REST)**, respons√°vel por:
- Receber e armazenar dados de sensores sonoros (ESP32);
- Gerenciar usu√°rios e autentica√ß√£o simples;
- Fornecer endpoints para o painel web e aplicativo mobile.

---

## ‚öôÔ∏è Tecnologias Utilizadas

| Tecnologia | Fun√ß√£o |
|-------------|---------|
| **Node.js** | Ambiente de execu√ß√£o do servidor |
| **Express.js** | Cria√ß√£o das rotas da API |
| **MongoDB Atlas** | Banco de dados em nuvem |
| **Mongoose** | Modelagem dos dados e integra√ß√£o com MongoDB |
| **dotenv** | Vari√°veis de ambiente e seguran√ßa |
| **bcryptjs** | Criptografia de senhas |
| **CORS** | Comunica√ß√£o entre frontends e backend |

---

## üß± Estrutura de Pastas

```
backend/
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îî‚îÄ‚îÄ db.js              ‚Üí conex√£o com MongoDB
‚îú‚îÄ‚îÄ controllers/
‚îÇ   ‚îú‚îÄ‚îÄ usuarioController.js ‚Üí cadastro e listagem de usu√°rios
‚îÇ   ‚îú‚îÄ‚îÄ sensorController.js  ‚Üí recebimento de dados dos sensores
‚îÇ   ‚îú‚îÄ‚îÄ salaController.js    ‚Üí gerenciamento das salas
‚îÇ   ‚îú‚îÄ‚îÄ alertaController.js  ‚Üí gera√ß√£o de alertas autom√°ticos
‚îÇ   ‚îî‚îÄ‚îÄ authController.js    ‚Üí autentica√ß√£o simples (login)
‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îú‚îÄ‚îÄ Usuario.js
‚îÇ   ‚îú‚îÄ‚îÄ SensorData.js
‚îÇ   ‚îú‚îÄ‚îÄ Sala.js
‚îÇ   ‚îî‚îÄ‚îÄ Alerta.js
‚îú‚îÄ‚îÄ routes/
‚îÇ   ‚îú‚îÄ‚îÄ usuarios.js
‚îÇ   ‚îú‚îÄ‚îÄ sensores.js
‚îÇ   ‚îú‚îÄ‚îÄ salas.js
‚îÇ   ‚îú‚îÄ‚îÄ alertas.js
‚îÇ   ‚îî‚îÄ‚îÄ auth.js
‚îú‚îÄ‚îÄ .env                     ‚Üí vari√°veis de ambiente (n√£o versionado)
‚îú‚îÄ‚îÄ .gitignore               ‚Üí protege .env e node_modules
‚îú‚îÄ‚îÄ package.json
‚îî‚îÄ‚îÄ server.js
```

---

## üöÄ Como Executar o Servidor

### üîß 1Ô∏è‚É£ Instalar depend√™ncias
No terminal, dentro da pasta `backend`:
```bash
npm install
```

### üåø 2Ô∏è‚É£ Configurar vari√°veis de ambiente
Crie um arquivo chamado `.env` com:
```
MONGO_URI=mongodb+srv://usuario:senha@seucluster.mongodb.net/ouviot
PORT=5000
```

> ‚ö†Ô∏è O `.env` est√° protegido pelo `.gitignore` e **n√£o deve ser versionado**.

### ‚ñ∂Ô∏è 3Ô∏è‚É£ Executar o servidor
```bash
npm start
```

Se tudo estiver correto:
```
‚úÖ Conectado ao MongoDB com sucesso!
üöÄ Servidor rodando na porta 5000
```

---

## üì° Endpoints Principais

### üë§ **Usu√°rios**
| M√©todo | Endpoint | Descri√ß√£o |
|--------|-----------|------------|
| `POST` | `/api/usuarios` | Cadastrar novo usu√°rio |
| `GET` | `/api/usuarios` | Listar todos os usu√°rios |
| `DELETE` | `/api/usuarios` | Deletar usu√°rio |

### üîê **Login**
| M√©todo | Endpoint | Descri√ß√£o |
|--------|-----------|------------|
| `POST` | `/api/login` | Autenticar usu√°rio (sem JWT) |

Exemplo de corpo:
```json
{
  "email": "mo@ouviot.com",
  "senha": "123456"
}
```

### üéß **Sensores**
| M√©todo | Endpoint | Descri√ß√£o |
|--------|-----------|------------|
| `POST` | `/api/sensores` | Receber dados de som (enviados pelo ESP32) |
| `GET` | `/api/sensores` | Listar √∫ltimas medi√ß√µes |

---

## üîê Autentica√ß√£o Simples
O backend realiza login b√°sico comparando o e-mail e senha criptografada via **bcrypt**.  
Ap√≥s o login, o frontend/mobile pode armazenar os dados do usu√°rio logado (`id`, `nome`, `tipo`) em:
- `localStorage` (vers√£o Web)
- `AsyncStorage` (vers√£o Mobile)

Exemplo de resposta:
```json
{
  "message": "Login realizado com sucesso!",
  "usuario": {
    "id": "6713f8c3...",
    "nome": "Mo Dev",
    "email": "mo@ouviot.com",
  }
}
```

